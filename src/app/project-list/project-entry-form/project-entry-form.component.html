<ng-template #tagList>
  <div class="tag-list flex flex-ver-ctr">
    <ul class="flex flex-ver-ctr mr-5">
      <li
        *ngFor="let tag of tags"
        class="badge flex no-select mr-3 m-bot-2"
        [class.bg-primary-light]="tag.type === 'ind'"
        [class.bg-secondary-light]="tag.type === 'fun'"
      >
        {{ tag.value }}
        <i
          class="bi bi-x-lg tag-delete clickable"
          (click)="onTagDelete(tag.value, 'form')"
        ></i>
      </li>
      <li>
        <i
          *ngIf="!showAddTag"
          class="bi bi-plus clickable add-tag"
          (click)="setShowAddTag(true)"
        ></i>
      </li>
      <li>
        <form *ngIf="showAddTag" (ngSubmit)="onTagSubmit('form')">
          <input
            #addTag
            class="form-control form-control-xs tag-input m-bot-2"
            type="text"
            [formControl]="tagInput"
            [typeahead]="getTagTypeahead()"
            (typeaheadOnSelect)="onTagSubmit('form')"
          />
        </form>
      </li>
    </ul>
  </div>
</ng-template>

<form
  #entryContainer
  [formGroup]="projectForm"
  (ngSubmit)="onSubmit()"
  class="entry-item tl-row"
  [class.entry-item--uncollapsed]="entryContainerWidth < 4 && !isCollapsed"
  novalidate
>
  <input
    class="form-control section section-name mr-12 mw-6"
    [class.is-invalid]="isFieldValid('client')"
    type="text"
    placeholder="Client"
    formControlName="client"
    required
  />
  <select
    class="form-control section section-skill mr-12 mw-3"
    [class.is-invalid]="isFieldValid('type')"
    formControlName="type"
  >
    <option value="EM">LOP</option>
    <option value="ASC">WS</option>
    <option value="FELL">PD</option>
    <option value="BA">OTH</option>
  </select>

  <span [ngClass]="getFieldClasses('days')">{{ getDaysAvailable() }}</span>

  <div class="calendar-group mr-12">
    <week-days
      class="flex flex-ver-ctr"
      [weekObj]="localCalendarObj"
      (calendarChange)="onCalendarChange($event)"
      [inEditMode]="true"
    ></week-days>
  </div>

  <div
    *ngIf="entryContainerWidth === 2 || entryContainerWidth > 2"
    [ngClass]="getFieldClasses('tags')"
  >
    <ng-container *ngTemplateOutlet="tagList"></ng-container>
  </div>
  <input
    *ngIf="entryContainerWidth === 4 || entryContainerWidth > 4"
    id="project-comments"
    class="form-control section section-comments mr-12"
    type="text"
    placeholder="Comments"
    formControlName="comments"
  />

  <div class="edit-entry-icons">
    <label for="{{ 'submit-form-' + id }}">
      <i class="bi bi-check-circle i-active mr-8"></i>
    </label>
    <i class="bi bi-trash i-active" (click)="handleDelete()"></i>
    <button id="{{ 'submit-form-' + id }}" type="submit" hidden></button>
  </div>
</form>

<div
  *ngIf="entryContainerWidth < 4"
  id="{{ 'collapse-' + id }}"
  [collapse]="isCollapsed"
  [isAnimated]="true"
>
  <div class="collapsed-section no-select" [formGroup]="projectForm">
    <span class="break-ver fs-12 mr-3"> | </span>
    <div *ngIf="entryContainerWidth < 2" [ngClass]="getFieldClasses('tags')">
      <ng-container *ngTemplateOutlet="tagList"></ng-container>
    </div>
    <span *ngIf="entryContainerWidth === 1" class="break-ver fs-12 mr-3">
      |
    </span>
    <input
      *ngIf="entryContainerWidth < 4"
      id="project-comments"
      class="form-control section section-comments mr-12"
      type="text"
      placeholder="Comments"
      formControlName="comments"
    />
  </div>
</div>
